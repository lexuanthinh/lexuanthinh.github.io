<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Tutorial - DSSAMA Docs</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">DSSAMA Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">English <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../en_getting_started/" class="dropdown-item">Home</a>
</li>
                                    
<li>
    <a href="../en_index/" class="dropdown-item">Index</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Tutorial</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Vietnamese <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../VN/vn_introduction/" class="dropdown-item">Introduction</a>
</li>
                                    
<li>
    <a href="../../VN/vn_getting_started/" class="dropdown-item">Home</a>
</li>
                                    
<li>
    <a href="../../VN/vn_machine_learning_pipeline/" class="dropdown-item">MachineLearningPipeline</a>
</li>
                                    
<li>
    <a href="../../VN/vn_tutorial/" class="dropdown-item">Tutorial</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../en_index/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../VN/vn_introduction/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#dssama-tutorial-for-data-projects" class="nav-link">DSSAMA Tutorial for Data Projects</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#1-predict-survival-of-titanic-passengers" class="nav-link">1. Predict survival of Titanic passengers</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#building-flow-regression-problems" class="nav-link">Building Flow Regression Problems</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#building-flow-for-clustering-problems" class="nav-link">Building Flow for Clustering problems</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#als-recommendation" class="nav-link">ALS Recommendation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#deploy-machine-learning-model" class="nav-link">Deploy Machine Learning model</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="dssama-tutorial-for-data-projects">DSSAMA Tutorial for Data Projects</h1>
<p>In this chapter, we will go in depths on how to use DSSAMA for classification machine learning problems, using the Titanic dataset as the example.</p>
<h2 id="1-predict-survival-of-titanic-passengers">1. Predict survival of Titanic passengers</h2>
<p><strong>Titanic – the classic case of predictive analysis</strong></p>
<p><code>Problem</code>: On April 15th 1912, the Titanic’s disaster went down as one of the most infamous catastrophes in naval history, the RMS Titanic sank after collided with an iceberg, taking 1502 lives of the 2224 passengers and crewmembers on board.</p>
<p><code>Input</code>: You are provided with training data of 892 passengers, including information on their names, gender, age, ticket number, cabinet, etc. and survival status.</p>
<p><code>Output</code>: You are required to create a model that can predict the survivability on the remaining passengers based on the provided fields of information.</p>
<p><code>Meaning</code>: The resultant predictive model will provide lessons and recommendations for future marine travel, such as safer ship design, customer service for vulnerable groups, or alerting mechanisms, etc.</p>
<p><code>Analysis</code>: It can be seen that this is a Two-Class Classification problem with the two outputs being NOT_SUVIVAL or SUVIVAL.</p>
<p>For a classification problem like this, there are many algorithms you can implement such as Naive Bayes, Decision Tree, Decision Forest …
In the dataset, each line represents a passenger with these fields of information as below:
Survival: 0 = No; 1 = Yes</p>
<p><code>Pclass</code>: Ticket class (1 = 1st, 2 = 2nd, 3 = 3rd)</p>
<p><code>Name</code>: Passenger’s name</p>
<p><code>Sex</code>: Sex</p>
<p><code>Age</code>: Age in years</p>
<p><code>SibSp</code>: Number of siblings / spouses aboard the Titanic</p>
<p><code>Parch</code>: Number of parents / children aboard the Titanic</p>
<p><code>Ticket</code>: Ticket number</p>
<p><code>Fare</code>: Passenger fare</p>
<p><code>Cabin</code>: Cabin number</p>
<p><code>Embarked</code>: Port of Embarkation (C = Cherbourg; Q = Queenstown; S = Southampton)</p>
<h3 id="getting-started"><strong><em>Getting started</em></strong></h3>
<h4 id="step-1-create-a-flow-for-this-problem"><em>Step 1</em>: Create a Flow for this problem.</h4>
<p><img alt="Hình 5. Flow Classification for Titanic" src="https://i.imgur.com/Zy7cHFR.png" />
<em>Figure 5. A Flow with name “Classification for Titanic”</em>
Click on the Flow to enter its working interface.
 <img alt="Hình 6. Flow Cassification for Titanic" src="https://i.imgur.com/kaj6ldHg.png" />
<em>Figure 6. Working Interface for Flow “Classification for Titanic”</em></p>
<h4 id="step-2-importing-data"><em>Step 2</em>: Importing data</h4>
<p>For the Titanic problem, data source type is Tabular, so in order to import it, we use Tabular Input Stage. Click Tabular Input Stage, move it to Dataflow Editor, when the Stage Properties window is displayed, we can choose the dataset and the columns to import.
 <img alt="Hình 7. Tabular Input" src="https://i.imgur.com/ORQ9pGE.png" />
- <em>Dataset</em>: Choose “Titanic”
- <em>Selected colunns</em>: Choose the columns you’ll use. In this example, the selected columns only include <code>PClass</code>, <code>Sex</code>, <code>Age</code>, <code>SibSp</code>, <code>Parch</code>, <code>Fare</code>. You can choose all the column if you like.
- Click again on the Stage and click Run to test if the data has been successfully imported.
- After that, a dashboard will be displayed as follow:  </p>
<h4 id="step-3-handling-missing-data">Step 3: Handling missing data</h4>
<p>In the Titanic dataset, the Age và Embarked columns have missing values which need to be rectified.
To solve missing data in Age column, choose Simple Imputer Transformer Stage in the Transformer package of Scikitsama.ml. Create a link from the Tabular Input Stage to the newly created imputer Stage. Adjust the properties as follow:
 <img alt="Hình 8." src="https://i.imgur.com/XWEkGky.png" />
- <em>Selected column</em>: Choose the column with missing data.
- <em>Missing Values</em>: Choose either np.nan hoặc None, based on how the dataset encodes missing data. In this case, the encoding is NaN.
- <em>Strategy</em>: Choose the missing-data-handling method from the below: 
    - mean: Fill missing data with the column’s average value.
    - median: Fill missing data with the column’s median value.
    - most_frequent: Fill missing data with the column’s most frequently occuring value.
    - constant: Fill missing data with a constant value, as defined in Fill Value text box. 
- Fill Value: only activated with constant option in Strategy
Once setup is finished, click <strong>Run</strong>.</p>
<h4 id="step-4-encode-du-lieu-dang-string">Step 4: Encode dữ liệu dạng string:</h4>
<p>Sex Column contains two values: Male và Female, which can’t be used to put in a ML model, so it needs encoding. Select One Hot Encoder Transformer Stage in Transformer subpackage of Scikitsama.ml. Link them with the previous Stages, select Sex Column and set the properties. After that, click on that Stage and click <strong>Run</strong>.
 <img alt="Hình 9." src="https://i.imgur.com/qzIr7TO.png" />
Besides One Hot Encoder Transformer we could also use other encoding methods in the same sub-package such as Ordinal Encoder Transformer.</p>
<h4 id="step-5-data-normalization">Step 5: Data Normalization:</h4>
<p>In our current problem, features are in different value ranges, which will make it difficult for the machine learning model to learn. To prevent that, we need to normalize data. In this case, we will normalize Age column. Select Normalize Transformer in Transformer sub-package of Scikitsama.ml, link it to the previous Stage (One Hot Encoder Transformer). Select colum Age, set the property click again on the Stage and click <strong>Run</strong>.
 <img alt="Hình 10" src="https://i.imgur.com/JDpS3el.png" /></p>
<h4 id="step-6-choosing-classification-algorithms">Step 6: Choosing Classification algorithms:</h4>
<p>DSSAMA Platform provides Classification Stages as shown below, you can choose one of them to complete the ML pipeline with the preprocessing steps taken before.
 <img alt="Hình 11" src="https://i.imgur.com/pLf1L4F.png" />
Each Stage’s properties is set up with default parameters for typical problems, you can change them according to your specific problems.
You can build the Flow as shown in the figure below: 
<img alt="Hình 12." src="https://i.imgur.com/rDcpkW6.png" /><br />
Execution results with Random Forest Classifier algorithm.<br />
<img alt="Hình 13. " src="https://i.imgur.com/rG66TOX.png" /></p>
<p><img alt="Hình 14. " src="https://i.imgur.com/5prNFBM.png" /></p>
<p><img alt="Hình 15. " src="https://i.imgur.com/GkBDX6Y.png" /></p>
<p>Some other machine learning implementations in DSSAMA
<img alt="Hình 16. Một số Flow Classification for Titanic " src="https://i.imgur.com/GxJe6Mk.png" />
  <em>Examples of Machine Learning algorithm</em> </p>
<h2 id="building-flow-regression-problems">Building Flow Regression Problems</h2>
<h2 id="building-flow-for-clustering-problems">Building Flow for Clustering problems</h2>
<h2 id="als-recommendation">ALS Recommendation</h2>
<h3 id="1-algorithm-description">1. Algorithm description:</h3>
<p><code>Alternating least squares (ALS)</code> is built upon the idea of decomposing an R matrix into two matrices U và V so that <img alt="math" src="https://latex.codecogs.com/gif.latex?R%5C%20%5Capprox%5C%20U%5ET%5Cast%20V" />. The row size of the unknown matrix is in number and provided as parameters for the algorithm, called hidden factors. Since Matrix Factorization can be used in the context, matrices U và V can be called User Matrix and Item Matrix respectively. Column i of User Matrix is denoted as <img alt="math" src="https://latex.codecogs.com/gif.latex?u_i" /> v and column I of Item Matrix denoted as <img alt="math" src="https://latex.codecogs.com/gif.latex?v_i" />. R Matrix can be called Ratings Matrix <img alt="math" src="https://latex.codecogs.com/gif.latex?%5Cleft%28R%5Cright%29_%7Bi%2Cj%7D%3D%5C%20r_%7Bi%2Cj%7D" />. To find user and item matrix, we need to optimize the cost function below:
<img alt="a" src="https://i.imgur.com/H2CdaBU.png" />
λ is the regularization coefficient, <img alt="math" src="https://latex.codecogs.com/gif.latex?n_%7Bu_i%7D" /> is the number of items rated by user I and <img alt="math" src="https://latex.codecogs.com/gif.latex?n_%7Bv_j%7D" /> is the number of times item j is rated. Regularization is used to prevent overfitting, called weighted-λ-regularization. Simultaneously optimizing U, V is computationally expensive, instead, the method is to alternating between optimization one matrix and freezing the other and vice versa, repeating until convergence. Matrix R is denoted as (i,j,r) in which: i is the number of rows, j is the number of columns, and r is the value of matrix at position (i, j)</p>
<h3 id="2-problem-description">2. Problem description:</h3>
<p>Use a .csv file with user rating for movies in the MovieLens dataset for ALS implementation
Output: A predictive model that can predict the level of rating a user may have for some movies as well as potential audience for a movie.
Dataset: a table with 10000 records and 3 columns:
- <code>Iduser</code>: id of the rater
- <code>Idmovie</code>: id of the movie
- <code>Rating</code>: the level of rate</p>
<h3 id="3-implementation-steps">3. Implementation steps:</h3>
<h4 id="step-1-add-the-csv-file-to-the-data-source-section-including-3-columns-iduser-idmovie-va-rating-in-your-workspace-do-not-select-id-column-and-label-column">Step 1: Add the .csv file to the data source section including 3 columns iduser, idmovie và rating in your Workspace (do not select ID Column and Label Column):</h4>
<p><img alt="" src="https://i.imgur.com/gn824Al.pngn" /></p>
<h4 id="step-2-create-a-new-flowt">Step 2: Create a new Flowt:</h4>
<p><img alt="" src="https://i.imgur.com/oIZTPYW.png" /></p>
<h3 id="step-3-create-a-new-flow-with-one-tabular-input-stage-and-1-als-stage">Step 3: Create a new flow with one Tabular Input Stage and 1 ALS stage:</h3>
<ul>
<li>With Tabular Input Stage: Choose the newly-added dataset and choose all the column.</li>
<li>With ALS Stage we need to pay attention to the following parameters:<ul>
<li>Type of Recommendation: Including 2 options: predicting rating levels from users to certain films (RECOMMENDATION_FOR_USERS) and predicting potential watcher for a film (RECOMMENDATION_FOR_ITEMS).</li>
<li>Number of Recommendation: Number of recommendations.</li>
<li>User Col: Select userId.</li>
<li>Item Col: Select movieId.</li>
<li>Rating Col: Select rating.</li>
<li>Rank: Number of hidden factors in the model (default 10).</li>
<li>Max Iter: Number of training iterations (default 10).</li>
<li>Reg Param: param regularization in ALS.</li>
<li>Cold Start Strategy: select ‘drop’.</li>
</ul>
</li>
</ul>
<h4 id="step-4-run-and-see-the-result">Step 4: Run and see the result:</h4>
<p><img alt="" src="https://i.imgur.com/qLDCfS5.png" />
•   Output: The top 10 highest-rate films by users.</p>
<h2 id="deploy-machine-learning-model">Deploy Machine Learning model</h2>
<h3 id="step-1-run-va-deploy-flow-on-dssama-platform">Step 1: Run và deploy Flow on DSSAMA platform</h3>
<ol>
<li>Import data: Choose Input Stage into Dataflow Editor. Create Flows for your problems.</li>
<li>Click Run. Once a flow is successfully executed, all the boxes will have green ticks</li>
<li>Click Deploy on the toolbar. 
<img alt="" src="https://i.imgur.com/N95KN7H.png" /></li>
</ol>
<h3 id="step-2-use-postman-deploy-flow">Step 2: Use Postman deploy Flow</h3>
<p><em><a href="https://www.postman.com/downloads/">Installing Postman</a></em>
After deploying the model successfulling, follow these steps:
1.  Call request URL : <code>API /releasedFlows</code> to get the list of deployed flow. 
<img alt="" src="https://i.imgur.com/Y4sa4tZ.png" />
2.  Call <code>API /release/ping/&lt;flow_id&gt;</code> to get information of the deployed flow according to <code>&lt;flow_id&gt;</code>.<img alt="" src="https://i.imgur.com/bHCzxRs.png" />
  <code>&lt;flow_id&gt;</code>   can be retrieved on the address bar of DSSAMA platform 
<img alt="" src="https://i.imgur.com/VN9EUa0.png" />
3.  Call <code>API /released/runflow/&lt;flow_id&gt;</code> to run deployed flow. Pass in the Request body:
<code>{    
    "datasets": 
    [ 
        { 
            "inputStageId": &lt;from results of section 2&gt;,
            "idCol": &lt;id column&gt;,
            "labelCol": &lt;label column&gt;,
            "dataType": &lt;data type&gt;,
            "data": &lt;data&gt;
        }
    ] 
 }</code>
<img alt="" src="https://i.imgur.com/qfTP6gZ.png" /> 
After sending request, the result will be returned as JSON file as follow:
 <img alt="" src="https://i.imgur.com/CT15D43.png" /></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
